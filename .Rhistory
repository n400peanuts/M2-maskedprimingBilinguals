merge(masterfileEng_OSC, db, by='Prime.x', all.x=T)-> masterfileEng_OSC
colnames(masterfileEng_OSC) <- c("Prime","Target","Subject","Age","Gender", "Handedness","Rotation",
"Data","OraStart" ,"TrialCount","TrialType","Relatedness","rt","Resp","Trial.ID","Target.ID","Lexicality","Morphtype","Primetype",
"Logfreq.Zipf.t","Lent","Lenp","Logfreq.Zipf.p","Nt","Np","Language","Accuracy","phoneticFluency","phoneticComprehension","morphComprehension",
"spelling","readingComprehension","vocabulary","oralComprehension","AoA1" ,
"AoA2","AoA3","AoA4","AoA5","AoA6", "AoA7","AoA8","AoA9","overallProf","OSC_Primes")
colnames(db) <- c('Target', 'OSC')
merge(masterfileEng_OSC, db, by='Target', all.x=T)-> masterfileEng_OSC
colnames(masterfileEng_OSC) <- c("Prime","Target","Subject","Age","Gender", "Handedness","Rotation",
"Data","OraStart" ,"TrialCount","TrialType","Relatedness","rt","Resp","Trial.ID","Target.ID","Lexicality","Morphtype","Primetype",
"Logfreq.Zipf.t","Lent","Lenp","Logfreq.Zipf.p","Nt","Np","Language","Accuracy","phoneticFluency","phoneticComprehension","morphComprehension",
"spelling","readingComprehension","vocabulary","oralComprehension","AoA1" ,
"AoA2","AoA3","AoA4","AoA5","AoA6", "AoA7","AoA8","AoA9", "overallProf","OSC_Primes","OSC_Target")
summary(masterfileEng_OSC)
rm(db, localGitDir, finalNumberofParticipants)
#---------------------------------------------------------------------------------------------------#
#                                          END                                                      #
#---------------------------------------------------------------------------------------------------#
inv <- function(x) { -1000/x}
subset(masterFile, Language=="eng")-> masterfileEng
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==1] <- 2;
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==0] <- 3;
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==2] <- 0;
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==3] <- 1;
subset(masterfileEng, masterfileEng$rt>350 & masterfileEng$rt<1800
& masterfileEng$Subject!=15 & masterfileEng$Subject!=22 & masterfileEng$Subject!=43
& masterfileEng$Lexicality=="WORD") -> dataAccENG
subset(dataAccENG, dataAccENG$Accuracy==1)-> datartENG
summary(datartENG)
round(xtabs(datartENG$rt ~ datartENG$Morphtype + datartENG$Primetype) / xtabs(~datartENG$Morphtype + datartENG$Primetype), digits = 0)
rm(rt, acc, sbj.id, target, lexicality, masterfileIta, masterfileEng);
englmer5 <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent +(1|Subject) + (1|Target), data= datartENG, REML = F)
summary(englmer5)
datartENG$Morphtype <- relevel(datartENG$Morphtype, "OR")
datartENG$Relatedness <- as.factor(datartENG$Relatedness)
englmer5 <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent +(1|Subject) + (1|Target), data= datartENG, REML = F)
summary(englmer5)
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
aa<- plotLMER.fnc(englmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ENG")
df <- effect("Relatedness:Morphtype",englmer5b)
library(effects)
df <- effect("Relatedness:Morphtype",englmer5b)
subset(masterFile, Language=="eng")-> masterfileEng
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==1] <- 2;
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==0] <- 3;
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==2] <- 0;
masterFile$Accuracy[masterFile$Subject==26 & masterFile$Accuracy==3] <- 1;
subset(masterfileEng, masterfileEng$rt>350 & masterfileEng$rt<1800
& masterfileEng$Subject!=15 & masterfileEng$Subject!=22 & masterfileEng$Subject!=43
& masterfileEng$Lexicality=="WORD") -> dataAccENG
subset(dataAccENG, dataAccENG$Accuracy==1)-> datartENG
summary(datartENG)
round(xtabs(datartENG$rt ~ datartENG$Morphtype + datartENG$Primetype) / xtabs(~datartENG$Morphtype + datartENG$Primetype), digits = 0)
rm(rt, acc, sbj.id, target, lexicality, masterfileIta, masterfileEng);
englmer5 <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent +(1|Subject) + (1|Target), data= datartENG, REML = F)
summary(englmer5)
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
aa<- plotLMER.fnc(englmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ENG")
df <- effect("Relatedness:Morphtype",englmer5b)
datartENG$Morphtype <- relevel(datartENG$Morphtype, "OR")
datartENG$Relatedness <- as.factor(datartENG$Relatedness)
englmer5 <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent +(1|Subject) + (1|Target), data= datartENG, REML = F)
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
anova(italmer5b)
subset(masterFile, Language=="ita")-> masterfileIta
subset(masterfileIta, masterfileIta$rt>300 & masterfileIta$Subject!=15 & masterfileIta$Subject!=2 & masterfileIta$Subject!=31  & masterfileIta$Subject!=43
& masterfileIta$Target!= "guano" & masterfileIta$Target!= "uggia" & masterfileIta$Target!= "vello" & masterfileIta$Lexicality=="WORD") -> dataAccITA
subset(dataAccITA, dataAccITA$Accuracy==1)-> datartITA
summary(datartITA)
round(xtabs(datartITA$rt ~ datartITA$Morphtype + datartITA$Primetype) / xtabs(~datartITA$Morphtype + datartITA$Primetype), digits = 0)
datartITA$Relatedness <- as.factor(datartITA$Relatedness)
datartITA$Morphtype <- relevel(datartITA$Morphtype, "OP")
italmer5 <- lmer(-1000/rt ~ Relatedness * Morphtype + Logfreq.Zipf.t + (1|Subject) + (1|Target), data= datartITA, REML = F)
anova(italmer4, italmer5)
summary(italmer5)
#5b
italmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + Logfreq.Zipf.t + (1|Subject) + (1|Target), data= subset(datartITA, abs(scale(resid(italmer5)))<2), REML = F)
summary(italmer5b)
anova(italmer5b)
anova(englmer5b)
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
aa<- plotLMER.fnc(englmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ENG")
df <- effect("Relatedness:Morphtype",englmer5b)
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
aa<- plotLMER.fnc(englmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ENG")
df <- effect("Relatedness:Morphtype",englmer5b)
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
df <- effect("Relatedness:Morphtype",englmer5b)
aa<- plotLMER.fnc(englmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ENG")
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
aa<- plotLMER.fnc(englmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ENG")
df <- effect("Relatedness:Morphtype",englmer5b)
df
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
anova(englmer5b)
df <- effect("Relatedness:Morphtype",englmer5b)
df
df <- effect("Relatedness:Morphtype",italmer5b)
df
italmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + Logfreq.Zipf.t + (1|Subject) + (1|Target), data= subset(datartITA, abs(scale(resid(italmer5)))<2), REML = F)
anova(italmer5b)
aa<-plotLMER.fnc(italmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ITA")
df <- effect("Relatedness:Morphtype",italmer5b)
df
df <- as.data.frame(df)
df
df <- effect("Relatedness:Morphtype",englmer5b)
df <- as.data.frame(df)
df
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
df
dodge <- position_dodge(width = 0.1)
gg  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
gg  <- gg + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
gg  <- gg + scale_y_continuous("RT(ms)",limits=c(510,595))
gg  <- gg + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
gg  <- gg + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
gg  <- gg + labs(x = "UNRELATED       RELATED ")
gg  <- gg + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
gg
dodge <- position_dodge(width = 0.1)
gg  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
gg  <- gg + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
gg
df
anova(italmer5b)
aa<-plotLMER.fnc(italmer5b, fun = inv, withList = TRUE, pred = "Relatedness", intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, xlabel ="Relatedness" , ylabel = "-1000/rt", main = "ITA")
df <- effect("Relatedness:Morphtype",italmer5b)
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
dodge <- position_dodge(width = 0.1)
bb  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
bb  <- bb + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
bb  <- bb + scale_y_continuous("RT(ms)",limits=c(510,675))
bb  <- bb + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
bb  <- bb + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
bb  <- bb + labs(x = "UNRELATED       RELATED ")
bb  <- bb + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
bb
ggsave("itaplot.jpg", height=4, width=5, dpi = 1000)
df <- effect("Relatedness:Morphtype",englmer5b)
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
dodge <- position_dodge(width = 0.1)
gg  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
gg  <- gg + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
gg  <- gg + scale_y_continuous("RT(ms)",limits=c(510,675))
gg  <- gg + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
gg  <- gg + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
gg  <- gg + labs(x = "UNRELATED       RELATED ")
gg  <- gg + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
gg
ggsave("engplot.jpg", height=4, width=5, dpi = 2000)
rm(gg, bb, aa, dodge)
df
dodge <- position_dodge(width = 0.1)
gg  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
gg  <- gg + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
gg  <- gg + scale_y_continuous("RT(ms)",limits=c(510,672))
gg  <- gg + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
gg  <- gg + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
gg  <- gg + labs(x = "UNRELATED       RELATED ")
gg  <- gg + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
gg
ggsave("engplot.jpg", height=4, width=5, dpi = 2000)
rm(gg, bb, aa, dodge)
proficiencylmer8 <- lmer(-1000/rt ~ Relatedness * Morphtype * overallProf + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data = datartENG);
anova(proficiencylmer0, proficiencylmer8); #ok, overall proficiency works nicely. Let's check how:
anova(proficiencylmer8); #mainly through interaction with morphtype; but close to significance in interaction with relatedness too. Let see what role outliers play here:
proficiencylmer8b <- lmer(-1000/rt ~ Relatedness * Morphtype * overallProf + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data = subset(datartENG, abs(scale(resid(proficiencylmer8)))<2));
summary(proficiencylmer8b)
anova(proficiencylmer8b); #wow, huge change! there must be many outliers, and really quite atypical. Which may be ok, it's L2 after all. If this is the story, cutting a little higher, say 2.5SD, should give p values half way btw here and the original model
proficiencylmer8c <- lmer(-1000/rt ~ Relatedness * Morphtype * overallProf + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data = subset(datartENG, abs(scale(resid(proficiencylmer8)))<2.5));
anova(proficiencylmer8c); #yeah, exactly as expected. So, I surely trust prof-by-morphtype, which is very reliable; and probably also prof-by-relatedness, which resist some outliers. The three way, I'm not sure, it really seems to be destroyed by just a few outliers. So, let's check out the nature of the effects:
par(mfrow=c(1,3));
a<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .1)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='VERY LOW PROFICIENCY', ylimit = c(570,700), bty='l');
b<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .5)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='LOW PROFICIENCY', ylimit = c(570,700), bty='l');
c<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .6)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='HIGH PROFICIENCY', ylimit = c(570,700), bty='l');
d<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .9)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='VERY HIGH PROFICIENCY', ylimit = c(570,700), bty='l');
par(mfrow=c(1,1));
par(mfrow=c(1,4));
a<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .1)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='VERY LOW PROFICIENCY', ylimit = c(570,700), bty='l');
b<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .5)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='LOW PROFICIENCY', ylimit = c(570,700), bty='l');
c<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .6)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='HIGH PROFICIENCY', ylimit = c(570,700), bty='l');
d<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .9)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='VERY HIGH PROFICIENCY', ylimit = c(570,700), bty='l');
par(mfrow=c(1,1));
par(mfrow=c(1,3));
a<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .1)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='VERY LOW PROFICIENCY', ylimit = c(570,700), bty='l');
b<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .5)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='LOW PROFICIENCY', ylimit = c(570,700), bty='l');
#c<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .6)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='HIGH PROFICIENCY', ylimit = c(570,700), bty='l');
d<- plotLMER.fnc(proficiencylmer8b, withList = TRUE, fun = inv, pred = "Relatedness",control = list("overallProf", quantile(datartENG$overallProf, .9)), intr = list("Morphtype", c("OR", "OP", "TR"), "end"), addlines = T, ylab='RT(ms)', xlabel = "Unrelated         Related", main='VERY HIGH PROFICIENCY', ylimit = c(570,700), bty='l');
par(mfrow=c(1,1));
df
df <- Effect("Relatedness:Morphtype",englmer5b)
df <- Effect(c("Relatedness:Morphtype"),englmer5b)
anova(englmer5b)
?Effect
df <- Effect(c("Relatedness","Morphtype"),englmer5b)
df
df <- as.data.frame(df)
df
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
df <- Effect(c("Relatedness","Morphtype"),englmer5b)
englmer5b <- lmer(-1000/rt ~ Relatedness * Morphtype + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data= subset(datartENG, abs(scale(resid(englmer5)))<2), REML = F)
df <- Effect(c("Relatedness","Morphtype"),englmer5b)
df <- allEffect(c("Relatedness","Morphtype"),englmer5b)
df <- allEffects(c("Relatedness","Morphtype"),englmer5b)
df <- allEffects(c("Relatedness","Morphtype"),englmer5b)
df <- allEffects(englmer5b)
df
df <- as.data.frame(df)
df <- effect("Relatedness:Morphtype",englmer5b)
df <- as.data.frame(df)
df
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
df
dodge <- position_dodge(width = 0.1)
gg  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
gg  <- gg + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
gg  <- gg + scale_y_continuous("RT(ms)",limits=c(510,672))
gg  <- gg + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
gg  <- gg + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
gg  <- gg + labs(x = "UNRELATED       RELATED ")
gg  <- gg + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
gg
df
effect
df <- effect("Relatedness:Morphtype",englmer5b, confidence.level = 68.2)
df <- Effect(c("Relatedness","Morphtype"),englmer5b, confidence.level = 0.68)
df
df <- as.data.frame(df)
df
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
dodge <- position_dodge(width = 0.1)
gg  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
gg  <- gg + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
gg  <- gg + scale_y_continuous("RT(ms)",limits=c(510,672))
gg  <- gg + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
gg  <- gg + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
gg  <- gg + labs(x = "UNRELATED       RELATED ")
gg  <- gg + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
gg
df <- effect("Relatedness:Morphtype",englmer5b)
df
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
df
df <- Effect(c("Relatedness","Morphtype"),englmer5b, confidence.level = 0.68) #report standard error of the mean
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
df
ggsave("engplot.jpg", height=4, width=5, dpi = 2000)
anova(proficiencylmer8b); #wow, huge change! there must be many outliers, and really quite atypical. Which may be ok, it's L2 after all. If this is the story, cutting a little higher, say 2.5SD, should give p values half way btw here and the original model
df <- effect("Relatedness:Morphtype:overallProf",proficiencylmer8b)
proficiencylmer8b <- lmer(-1000/rt ~ Relatedness * Morphtype * overallProf + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data = subset(datartENG, abs(scale(resid(proficiencylmer8)))<2));
df <- effect("Relatedness:Morphtype:overallProf",proficiencylmer8b)
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
df
dodge <- position_dodge(width = 0.1)
a <-ggplot(data = df, aes(x = Relatedness, y = Y, col = Morphtype ,group = overallProf)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a
a <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = overallProf)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a
a <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = overallProf[overallProf==40])) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a
a <-ggplot(data = df, aes(x = Relatedness[overallProf==40], y = fit[overallProf==40], col = Morphtype[overallProf==40] ,group = overallProf[overallProf==40])) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a
df
subset(df, df$overallProf==40)-> lowProf
lowProf
a <-ggplot(data = lowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = overallProf)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a
dodge <- position_dodge(width = 0.1)
a <-ggplot(data = lowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = overallProf)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a
a <-ggplot(data = lowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a
lowProf
a <- a + geom_errorbar(aes(ymin = df$lower - df$upper, ymax = limitsforgraph$mean + limitsforgraph$se), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
a
a <-ggplot(data = lowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a <- a + geom_errorbar(aes(ymin = lowProf$lower, ymax =lowProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
a
a <- a + scale_y_continuous("RT(ms)",limits=c(550,690))
a
a <- a + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
a <- a + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
a <- a + labs(x = "UNRELATED       RELATED ")
a <- a + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
a
ggsave("firsquartileProficiency.jpg", height=6, width=6, dpi = 2000)
df
subset(df, df$overallProf>40 & df$overallProf<=80)-> mediumProf
dodge <- position_dodge(width = 0.1)
b <-ggplot(data = mediumProf, aes(x = Relatedness, y = Y, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
b <- b + geom_errorbar(aes(ymin = mediumProf$lower, ymax = mediumProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
b
b <-ggplot(data = mediumProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
b <- b + geom_errorbar(aes(ymin = mediumProf$lower, ymax = mediumProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
b
dodge <- position_dodge(width = 0.1)
b <-ggplot(data = mediumProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
b
df
subset(df, df$overallProf==60)-> lowProf
subset(df, df$overallProf==60)-> lowProf
dodge <- position_dodge(width = 0.1)
b <-ggplot(data = lowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
b <- b + geom_errorbar(aes(ymin = lowProf$lower, ymax = lowProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
b
b <- b + scale_y_continuous("RT(ms)",limits=c(550,690))
b <- b + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
b <- b + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
b <- b + labs(x = "UNRELATED       RELATED ")
b <- b + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
b
ggsave("secondquartileProficiency.jpg", height=6, width=6, dpi = 2000)
subset(df, df$overallProf==80)-> highProf
#Terzo quartile
subset(df, df$overallProf==80)-> highProf
dodge <- position_dodge(width = 0.1)
c <-ggplot(data = highProf, aes(x = Relatedness, y = Y, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
c <- c + scale_y_continuous("RT(ms)",limits=c(550,690))
c <- c + geom_errorbar(aes(ymin = highProf$lower, ymax = highProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
c <- c + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
c <- c + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
c <- c + labs(x = "UNRELATED       RELATED ")
c <- c + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
c
subset(df, df$overallProf==80)-> highProf
dodge <- position_dodge(width = 0.1)
c <-ggplot(data = highProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
c <- c + scale_y_continuous("RT(ms)",limits=c(550,690))
c <- c + geom_errorbar(aes(ymin = highProf$lower, ymax = highProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
c <- c + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
c <- c + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
c <- c + labs(x = "UNRELATED       RELATED ")
c <- c + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
c
ggsave("thirdquartileProficiency.jpg", height=6, width=6, dpi = 2000)
subset(df, df$overallProf>80)-> veryhighProf
dodge <- position_dodge(width = 0.1)
d <-ggplot(data = veryhighProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
d <- d + scale_y_continuous("RT(ms)",limits=c(550,690))
d <- d + geom_errorbar(aes(ymin = veryhighProf$lower, ymax = veryhighProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
d <- d + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
d <- d + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
d <- d + labs(x = "UNRELATED       RELATED ")
d <- d + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
d
subset(df, df$overallProf>80)-> veryhighProf
veryhighProf
dodge <- position_dodge(width = 0.1)
d <-ggplot(data = veryhighProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
d <- d + geom_errorbar(aes(ymin = veryhighProf$lower, ymax = veryhighProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
d <- d + scale_y_continuous("RT(ms)",limits=c(550,710))
d <- d + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
d <- d + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
d <- d + labs(x = "UNRELATED       RELATED ")
d <- d + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
d
ggsave("fourthquartileProficiency.jpg", height=6, width=6, dpi = 2000)
anova(proficiencylmer8b); #wow, huge change! there must be many outliers, and really quite atypical. Which may be ok, it's L2 after all. If this is the story, cutting a little higher, say 2.5SD, should give p values half way btw here and the original model
anova(proficiencylmer8c); #yeah, exactly as expected. So, I surely trust prof-by-morphtype, which is very reliable; and probably also prof-by-relatedness, which resist some outliers. The three way, I'm not sure, it really seems to be destroyed by just a few outliers. So, let's check out the nature of the effects:
anova(proficiencylmer8); #mainly through interaction with morphtype; but close to significance in interaction with relatedness too. Let see what role outliers play here:
anova(proficiencylmer8b); #wow, huge change! there must be many outliers, and really quite atypical. Which may be ok, it's L2 after all. If this is the story, cutting a little higher, say 2.5SD, should give p values half way btw here and the original model
datartENG$Relatedness <- factor(datartENG$Relatedness);
proficiencylmer8 <- lmer(-1000/rt ~ Relatedness * Morphtype * overallProf + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data = datartENG);
proficiencylmer8b <- lmer(-1000/rt ~ Relatedness * Morphtype * overallProf + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data = subset(datartENG, abs(scale(resid(proficiencylmer8)))<2));
proficiencylmer8c <- lmer(-1000/rt ~ Relatedness * Morphtype * overallProf + rcs(TrialCount) + Logfreq.Zipf.t + Lent + (1|Subject) + (1|Target), data = subset(datartENG, abs(scale(resid(proficiencylmer8)))<2.5));
anova(proficiencylmer8b); #wow, huge change! there must be many outliers, and really quite atypical. Which may be ok, it's L2 after all. If this is the story, cutting a little higher, say 2.5SD, should give p values half way btw here and the original model
anova(proficiencylmer8c); #yeah, exactly as expected. So, I surely trust prof-by-morphtype, which is very reliable; and probably also prof-by-relatedness, which resist some outliers. The three way, I'm not sure, it really seems to be destroyed by just a few outliers. So, let's check out the nature of the effects:
#Primo quartile
df <- effect("Relatedness:Morphtype:overallProf",proficiencylmer8b)
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
subset(df, df$overallProf==40)-> verylowProf
# plot using ggplot
dodge <- position_dodge(width = 0.1)
a <-ggplot(data = verylowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a <- a + geom_errorbar(aes(ymin = verylowProf$lower, ymax =verylowProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
a <- a + scale_y_continuous("RT(ms)",limits=c(550,690))
a <- a + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
a <- a + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
a <- a + labs(x = "UNRELATED       RELATED ")
a <- a + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
a
ggsave("firsquartileProficiency.jpg", height=6, width=6, dpi = 2000)
#Secondo quartile
subset(df, df$overallProf==60)-> lowProf
dodge <- position_dodge(width = 0.1)
b <-ggplot(data = lowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
b <- b + geom_errorbar(aes(ymin = lowProf$lower, ymax = lowProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
b <- b + scale_y_continuous("RT(ms)",limits=c(550,690))
b <- b + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
b <- b + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
b <- b + labs(x = "UNRELATED       RELATED ")
b <- b + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
b
ggsave("secondquartileProficiency.jpg", height=6, width=6, dpi = 2000)
#Primo quartile
df <- effect("Relatedness:Morphtype:overallProf",proficiencylmer8b)
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
subset(df, df$overallProf==40)-> verylowProf
# plot using ggplot
dodge <- position_dodge(width = 0.1)
a <-ggplot(data = verylowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
a <- a + geom_errorbar(aes(ymin = verylowProf$lower, ymax =verylowProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
a <- a + scale_y_continuous("RT(ms)",limits=c(550,710))
a <- a + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
a <- a + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
a <- a + labs(x = "UNRELATED       RELATED ")
a <- a + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
a
ggsave("firsquartileProficiency.jpg", height=6, width=6, dpi = 2000)
#Secondo quartile
subset(df, df$overallProf==60)-> lowProf
dodge <- position_dodge(width = 0.1)
b <-ggplot(data = lowProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
b <- b + geom_errorbar(aes(ymin = lowProf$lower, ymax = lowProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
b <- b + scale_y_continuous("RT(ms)",limits=c(550,710))
b <- b + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
b <- b + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
b <- b + labs(x = "UNRELATED       RELATED ")
b <- b + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
b
ggsave("secondquartileProficiency.jpg", height=6, width=6, dpi = 2000)
#Terzo quartile
subset(df, df$overallProf==80)-> highProf
dodge <- position_dodge(width = 0.1)
c <-ggplot(data = highProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
c <- c + geom_errorbar(aes(ymin = highProf$lower, ymax = highProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
c <- c + scale_y_continuous("RT(ms)",limits=c(550,710))
c <- c + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
c <- c + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
c <- c + labs(x = "UNRELATED       RELATED ")
c <- c + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
c
ggsave("thirdquartileProficiency.jpg", height=6, width=6, dpi = 2000)
#quarto quartile
subset(df, df$overallProf>80)-> veryhighProf
dodge <- position_dodge(width = 0.1)
d <-ggplot(data = veryhighProf, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
d <- d + geom_errorbar(aes(ymin = veryhighProf$lower, ymax = veryhighProf$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
d <- d + scale_y_continuous("RT(ms)",limits=c(550,710))
d <- d + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
d <- d + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
d <- d + labs(x = "UNRELATED       RELATED ")
d <- d + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
d
ggsave("fourthquartileProficiency.jpg", height=6, width=6, dpi = 2000)
df <- effect("Relatedness:Morphtype",italmer5b)
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
dodge <- position_dodge(width = 0.1)
bb  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
bb  <- bb + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
bb  <- bb + scale_y_continuous("RT(ms)",limits=c(510,675))
bb  <- bb + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
bb  <- bb + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
bb  <- bb + labs(x = "UNRELATED       RELATED ")
bb  <- bb + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
bb
ggsave("itaplot.jpg", height=6, width=6, dpi = 2000)
df <- effect("Relatedness:Morphtype",englmer5b)
df <- as.data.frame(df)
df$fit <- inv(df$fit)
df$lower <- inv(df$lower)
df$upper <- inv(df$upper)
dodge <- position_dodge(width = 0.1)
gg  <-ggplot(data = df, aes(x = Relatedness, y = fit, col = Morphtype ,group = Morphtype)) + scale_colour_manual(breaks = c("OR", "OP", "TR"), values = c("#0000e8", "#000000", "#ff0030")) + geom_point(position = dodge, size = 4.5, shape=21, fill="white") + geom_line(position = dodge)+ theme_classic()
gg  <- gg + geom_errorbar(aes(ymin = df$lower, ymax = df$upper), width=0.1, size=1, linetype=1, position = dodge) #FUCK YEAH
gg  <- gg + scale_y_continuous("RT(ms)",limits=c(510,672))
gg  <- gg + theme(axis.title.y = element_text(size = rel(1.5), angle = 90))
gg  <- gg + theme(axis.text.y = element_text(angle = 00, hjust = 1, size=13, face = 'bold', colour = 'black'))
gg  <- gg + labs(x = "UNRELATED       RELATED ")
gg  <- gg + theme(axis.title.x = element_text(size = rel(1), face = 'bold'))
gg
ggsave("engplot.jpg", height=6, width=6, dpi = 2000)
rm(gg, bb, aa, dodge)
